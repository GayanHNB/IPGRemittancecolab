<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Secure remittance platform for sending money to Sri Lanka">
    <title>HNB Secure Remittance Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #0077b6;
            --secondary-color: #0096c7;
            --success-color: #ffc107;
            --error-color: #dc3545;
            --light-gray: #f0f8ff;
            --dark-gray: #343a40;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: var(--light-gray);
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background-color: var(--secondary-color);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        header img {
            height: 60px;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            display: flex;
            background-color: #e9ecef;
            height: 10px;
            margin-bottom: 20px;
        }
        
        .progress-step {
            flex: 1;
            height: 100%;
            background-color: #adb5bd;
        }
        
        .progress-step.active {
            background-color: var(--success-color);
        }
        
        .form-container {
            padding: 30px;
        }
        
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
        }
        
        h2 {
            color: var(--secondary-color);
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .required:after {
            content: " *";
            color: var(--error-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(0, 119, 182, 0.25);
        }
        
        .input-group {
            display: flex;
        }
        
        .country-code {
            width: 80px;
            text-align: center;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ced4da;
            border-right: none;
            border-radius: 4px 0 0 4px;
            font-weight: bold;
        }
        
        .phone-input {
            flex: 1;
            border-radius: 0 4px 4px 0;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #005f92;
        }
        
        .btn-secondary {
            background-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .calculation-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid var(--success-color);
        }
        
        .calculation-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .calculation-row.total {
            font-weight: bold;
            border-top: 1px solid #dee2e6;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .error-message {
            color: var(--error-color);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        input.error, select.error {
            border-color: var(--error-color);
        }
        
        input.error + .error-message {
            display: block;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: var(--dark-gray);
            color: white;
            font-size: 14px;
        }
        
        footer a {
            color: white;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
        
        .secure-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            color: var(--success-color);
        }
        
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .summary-table th, .summary-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .summary-table th {
            background-color: #f2f2f2;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .btn {
                padding: 10px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="https://www.hnb.net/wp-content/uploads/2023/05/HNB-Logo.png" alt="HNB Logo">
            <h1>Secure Remittance Platform</h1>
            <p>Send money to Sri Lanka quickly and securely</p>
        </header>
        
        <div class="progress-bar">
            <div class="progress-step active" id="step1-progress"></div>
            <div class="progress-step" id="step2-progress"></div>
            <div class="progress-step" id="step3-progress"></div>
        </div>
        
        <div class="form-container">
            <!-- Step 1: Transaction Details -->
            <div class="form-step active" id="step1">
                <h2>Transaction Details</h2>
                
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i> Today's exchange rate: <strong>1 USD = 322.00 LKR</strong> (subject to change)
                </div>
                
                <div class="form-group">
                    <label for="transaction-purpose" class="required">Purpose of Remittance</label>
                    <select id="transaction-purpose" required>
                        <option value="">Select purpose</option>
                        <option value="family-maintenance">Family Maintenance</option>
                        <option value="education">Education</option>
                        <option value="medical">Medical Expenses</option>
                        <option value="investment">Investment</option>
                        <option value="property">Property Purchase</option>
                        <option value="donation">Donation</option>
                        <option value="gift">Gift</option>
                        <option value="business">Business Transactions</option>
                        <option value="loan">Loan Repayment</option>
                        <option value="salary">Salary Transfer</option>
                        <option value="other">Other</option>
                    </select>
                    <div class="error-message">Please select a purpose</div>
                </div>
                
                <div class="form-group">
                    <label for="amount-lkr" class="required">Amount to Send (LKR)</label>
                    <input type="number" id="amount-lkr" min="1000" max="100000" required oninput="calculateCharges()">
                    <div class="error-message">Please enter an amount between LKR 1,000 and 100,000</div>
                </div>
                
                <div class="calculation-box">
                    <div class="calculation-row">
                        <span>Amount (LKR):</span>
                        <span id="display-amount-lkr">0.00</span>
                    </div>
                    <div class="calculation-row">
                        <span>Exchange Rate:</span>
                        <span>1 USD = <span id="display-rate">322.00</span> LKR</span>
                    </div>
                    <div class="calculation-row">
                        <span>Transfer Fee:</span>
                        <span id="display-fee">0.00 USD</span>
                    </div>
                    <div class="calculation-row total">
                        <span>Total Amount to Pay:</span>
                        <span id="display-total">0.00 USD</span>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn" onclick="nextStep()">Continue <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            
            <!-- Step 2: Beneficiary Details -->
            <div class="form-step" id="step2">
                <h2>Beneficiary Details</h2>
                
                <div class="form-group">
                    <label for="beneficiary-bank" class="required">Beneficiary Bank</label>
                    <select id="beneficiary-bank" required onchange="checkAccountType()">
                        <option value="">Select bank</option>
                        <optgroup label="Commercial Banks">
                            <option value="HNB">Hatton National Bank PLC</option>
                            <option value="BOC">Bank of Ceylon</option>
                            <option value="PEOPLES">People's Bank</option>
                            <option value="COMMERCIAL">Commercial Bank of Ceylon PLC</option>
                            <option value="SAMPATH">Sampath Bank PLC</option>
                            <option value="NSB">National Savings Bank</option>
                            <option value="DFCC">DFCC Bank PLC</option>
                            <option value="SEYLAN">Seylan Bank PLC</option>
                            <option value="NTB">Nations Trust Bank PLC</option>
                            <option value="HDFC">HDFC Bank</option>
                            <option value="PUBLIC">Public Bank</option>
                            <option value="CARGILLS">Cargills Bank</option>
                            <option value="PANASIA">Pan Asia Banking Corporation</option>
                            <option value="SINHALA">Sinhala Bank</option>
                            <option value="UNION">Union Bank</option>
                        </optgroup>
                        <optgroup label="Specialized Banks">
                            <option value="LB">Lankaputhra Development Bank</option>
                            <option value="RDB">Regional Development Bank</option>
                            <option value="SDB">State Mortgage & Investment Bank</option>
                            <option value="NDB">National Development Bank</option>
                        </optgroup>
                        <optgroup label="Finance Companies">
                            <option value="PLC">People's Leasing & Finance</option>
                            <option value="MBSL">Merchant Bank of Sri Lanka</option>
                            <option value="VALLIBEL">Vallibel Finance</option>
                            <option value="LBFC">LB Finance</option>
                            <option value="SANASA">Sanasa Development Bank</option>
                        </optgroup>
                        <option value="OTHER">Other Bank/Financial Institution</option>
                    </select>
                    <div class="error-message">Please select a bank</div>
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-account-type" class="required">Account Type</label>
                    <select id="beneficiary-account-type" required>
                        <option value="">Select account type</option>
                        <option value="savings">Savings Account</option>
                        <option value="nrfc" id="nrfc-option">NRFC Account (USD)</option>
                    </select>
                    <div class="error-message">Please select an account type</div>
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-account" class="required">Account Number</label>
                    <input type="text" id="beneficiary-account" pattern="[0-9]{8,20}" required>
                    <div class="error-message">Please enter a valid account number (8-20 digits)</div>
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-name" class="required">Beneficiary Name</label>
                    <input type="text" id="beneficiary-name" required>
                    <div class="error-message">Please enter beneficiary name</div>
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-address">Beneficiary Address (Optional)</label>
                    <input type="text" id="beneficiary-address">
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-email">Beneficiary Email (Optional)</label>
                    <input type="email" id="beneficiary-email">
                    <div class="error-message">Please enter a valid email address</div>
                </div>
                
                <div class="form-group">
                    <label for="beneficiary-phone">Beneficiary Phone Number (Optional)</label>
                    <div class="input-group">
                        <div class="country-code">+94</div>
                        <input type="tel" id="beneficiary-phone" class="phone-input" pattern="[0-9]{9}">
                    </div>
                    <div class="error-message">Please enter a valid 9-digit phone number</div>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> Back</button>
                    <button type="button" class="btn" onclick="nextStep()">Continue <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            
            <!-- Step 3: Remitter Details & Payment -->
            <div class="form-step" id="step3">
                <h2>Your Details & Payment</h2>
                
                <div class="form-group">
                    <label for="remitter-name" class="required">Your Full Name</label>
                    <input type="text" id="remitter-name" required>
                    <div class="error-message">Please enter your name</div>
                </div>
                
                <div class="form-group">
                    <label for="remitter-country" class="required">Country of Residence</label>
                    <select id="remitter-country" required onchange="updateCountryCode()">
                        <option value="">Select country</option>
                        <option value="USA">United States</option>
                        <option value="UK">United Kingdom</option>
                        <option value="UAE">United Arab Emirates</option>
                        <option value="Canada">Canada</option>
                        <option value="Australia">Australia</option>
                        <option value="New Zealand">New Zealand</option>
                        <option value="Singapore">Singapore</option>
                        <option value="Malaysia">Malaysia</option>
                        <option value="Japan">Japan</option>
                        <option value="South Korea">South Korea</option>
                        <option value="China">China</option>
                        <option value="India">India</option>
                        <option value="Maldives">Maldives</option>
                        <option value="Qatar">Qatar</option>
                        <option value="Saudi Arabia">Saudi Arabia</option>
                        <option value="Kuwait">Kuwait</option>
                        <option value="Oman">Oman</option>
                        <option value="Bahrain">Bahrain</option>
                        <option value="Germany">Germany</option>
                        <option value="France">France</option>
                        <option value="Italy">Italy</option>
                        <option value="Spain">Spain</option>
                        <option value="Switzerland">Switzerland</option>
                        <option value="Netherlands">Netherlands</option>
                        <option value="Sweden">Sweden</option>
                        <option value="Norway">Norway</option>
                        <option value="Denmark">Denmark</option>
                        <option value="Finland">Finland</option>
                        <option value="Other">Other Country</option>
                    </select>
                    <div class="error-message">Please select your country</div>
                </div>
                
                <div class="form-group">
                    <label for="remitter-phone" class="required">Phone Number</label>
                    <div class="input-group">
                        <div class="country-code" id="remitter-country-code">+1</div>
                        <input type="tel" id="remitter-phone" class="phone-input" required>
                    </div>
                    <div class="error-message">Please enter a valid phone number</div>
                </div>
                
                <div class="form-group">
                    <label for="remitter-email" class="required">Email Address</label>
                    <input type="email" id="remitter-email" required>
                    <div class="error-message">Please enter a valid email address</div>
                </div>
                
                <div class="form-group">
                    <label for="remitter-address">Address (Optional)</label>
                    <input type="text" id="remitter-address">
                </div>
                
                <div class="alert alert-info">
                    <i class="fas fa-lock"></i> Your payment information will be processed securely through our PCI-DSS compliant payment gateway.
                </div>
                
                <div class="form-group">
                    <label class="required">Payment Method</label>
                    <div class="payment-methods">
                        <div class="payment-option">
                            <input type="radio" id="payment-card" name="payment-method" value="card" checked>
                            <label for="payment-card">
                                <i class="fab fa-cc-visa"></i> <i class="fab fa-cc-mastercard"></i> Credit/Debit Card
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Payment form would be loaded here via payment gateway -->
                <div id="payment-form-container">
                    <div class="form-group">
                        <label for="card-number" class="required">Card Number</label>
                        <input type="text" id="card-number" placeholder="1234 5678 9012 3456" pattern="[0-9\s]{13,19}" required>
                        <div class="error-message">Please enter a valid card number</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="card-name" class="required">Name on Card</label>
                        <input type="text" id="card-name" required>
                        <div class="error-message">Please enter the name on your card</div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group" style="flex: 1; margin-right: 15px;">
                            <label for="card-expiry" class="required">Expiry Date</label>
                            <input type="text" id="card-expiry" placeholder="MM/YY" pattern="(0[1-9]|1[0-2])\/[0-9]{2}" required>
                            <div class="error-message">Please enter a valid expiry date</div>
                        </div>
                        
                        <div class="form-group" style="flex: 1;">
                            <label for="card-cvv" class="required">CVV</label>
                            <input type="text" id="card-cvv" placeholder="123" pattern="[0-9]{3,4}" required>
                            <div class="error-message">Please enter a valid CVV</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <input type="checkbox" id="terms-agreement" required>
                    <label for="terms-agreement">I agree to the <a href="#" target="_blank">Terms of Service</a> and <a href="#" target="_blank">Privacy Policy</a></label>
                    <div class="error-message">You must agree to the terms</div>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> Back</button>
                    <button type="button" class="btn" onclick="submitForm()">Complete Transaction <i class="fas fa-lock"></i></button>
                </div>
            </div>
            
            <!-- Confirmation Step (hidden initially) -->
            <div class="form-step" id="confirmation">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i> <strong>Transaction Successful!</strong>
                </div>
                
                <h2>Transaction Confirmation</h2>
                
                <div class="confirmation-details">
                    <table class="summary-table">
                        <tr>
                            <th>Field</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Reference Number</td>
                            <td id="confirmation-ref">HNB-REM-20230615-123456</td>
                        </tr>
                        <tr>
                            <td>Purpose</td>
                            <td id="confirmation-purpose">Family Maintenance</td>
                        </tr>
                        <tr>
                            <td>Amount Sent</td>
                            <td id="confirmation-amount">25,000.00 LKR</td>
                        </tr>
                        <tr>
                            <td>Total Charged</td>
                            <td id="confirmation-total">82.47 USD</td>
                        </tr>
                        <tr>
                            <td>Beneficiary Bank</td>
                            <td id="confirmation-bank">Hatton National Bank PLC</td>
                        </tr>
                        <tr>
                            <td>Account Type</td>
                            <td id="confirmation-account-type">Savings Account</td>
                        </tr>
                        <tr>
                            <td>Account Number</td>
                            <td id="confirmation-account">1234567890</td>
                        </tr>
                        <tr>
                            <td>Beneficiary Name</td>
                            <td id="confirmation-beneficiary">John Doe</td>
                        </tr>
                        <tr>
                            <td>Your Name</td>
                            <td id="confirmation-remitter">Jane Smith</td>
                        </tr>
                        <tr>
                            <td>Your Country</td>
                            <td id="confirmation-country">United States</td>
                        </tr>
                        <tr>
                            <td>Payment Method</td>
                            <td>Credit/Debit Card</td>
                        </tr>
                        <tr>
                            <td>Estimated Delivery</td>
                            <td id="confirmation-delivery">Within 1 business day</td>
                        </tr>
                    </table>
                </div>
                
                <p>A confirmation email has been sent to <strong id="confirmation-email">user@example.com</strong> with these details.</p>
                
                <div class="btn-group">
                    <button type="button" class="btn" onclick="window.print()"><i class="fas fa-print"></i> Print Receipt</button>
                    <button type="button" class="btn" onclick="newTransaction()"><i class="fas fa-exchange-alt"></i> New Transaction</button>
                </div>
            </div>
        </div>
        
        <div class="secure-badge">
            <i class="fas fa-shield-alt"></i>
            <span>256-bit SSL Secured Transaction</span>
        </div>
        
        <footer>
            <p>&copy; 2023 Hatton National Bank PLC. All Rights Reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
            <p>Registered with the Central Bank of Sri Lanka as a Licensed Remittance Service Provider</p>
        </footer>
    </div>

    <script>
        // Current step tracking
        let currentStep = 1;
        const totalSteps = 3;
        
        // Country code mapping
        const countryCodeMap = {
            "USA": "+1",
            "UK": "+44",
            "UAE": "+971",
            "Canada": "+1",
            "Australia": "+61",
            "New Zealand": "+64",
            "Singapore": "+65",
            "Malaysia": "+60",
            "Japan": "+81",
            "South Korea": "+82",
            "China": "+86",
            "India": "+91",
            "Maldives": "+960",
            "Qatar": "+974",
            "Saudi Arabia": "+966",
            "Kuwait": "+965",
            "Oman": "+968",
            "Bahrain": "+973",
            "Germany": "+49",
            "France": "+33",
            "Italy": "+39",
            "Spain": "+34",
            "Switzerland": "+41",
            "Netherlands": "+31",
            "Sweden": "+46",
            "Norway": "+47",
            "Denmark": "+45",
            "Finland": "+358",
            "Other": ""
        };
        
        // Exchange rate and fee structure
        const exchangeRate = 322.00;
        const feeStructure = [
            { min: 1000, max: 5000, fee: 1.00 },
            { min: 5001, max: 10000, fee: 1.00 },
            { min: 10001, max: 15000, fee: 1.50 },
            { min: 15001, max: 20000, fee: 2.00 },
            { min: 20001, max: 25000, fee: 2.50 },
            { min: 25001, max: 50000, fee: 3.00 },
            { min: 50001, max: 70000, fee: 5.50 },
            { min: 70001, max: 90000, fee: 8.00 },
            { min: 90001, max: 100000, fee: 10.50 }
        ];
        
        // Initialize form
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById('display-rate').textContent = exchangeRate.toFixed(2);
            updateCountryCode();
            generateReference();
            checkAccountType();
        });
        
        // Check account type based on bank selection
        function checkAccountType() {
            const bankSelect = document.getElementById('beneficiary-bank');
            const accountTypeSelect = document.getElementById('beneficiary-account-type');
            const nrfcOption = document.getElementById('nrfc-option');
            
            // Enable all options first
            Array.from(accountTypeSelect.options).forEach(option => {
                option.disabled = false;
            });
            
            // If selected bank is HNB, enable NRFC option
            if (bankSelect.value === 'HNB') {
                nrfcOption.disabled = false;
            } else {
                // For other banks, disable NRFC option
                nrfcOption.disabled = true;
                
                // If NRFC was selected, reset to empty
                if (accountTypeSelect.value === 'nrfc') {
                    accountTypeSelect.value = '';
                }
            }
        }
        
        // Navigation functions
        function nextStep() {
            if (validateStep(currentStep)) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}-progress`).classList.remove('active');
                
                currentStep++;
                
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`step${currentStep}-progress`).classList.add('active');
                
                // Scroll to top
                window.scrollTo(0, 0);
            }
        }
        
        function prevStep() {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step${currentStep}-progress`).classList.remove('active');
            
            currentStep--;
            
            document.getElementById(`step${currentStep}`).classList.add('active');
            document.getElementById(`step${currentStep}-progress`).classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Form validation
        function validateStep(step) {
            let isValid = true;
            
            // Step 1 validation
            if (step === 1) {
                const amountLkr = document.getElementById('amount-lkr');
                const purpose = document.getElementById('transaction-purpose');
                
                if (!purpose.value) {
                    purpose.classList.add('error');
                    purpose.nextElementSibling.style.display = 'block';
                    isValid = false;
                } else {
                    purpose.classList.remove('error');
                    purpose.nextElementSibling.style.display = 'none';
                }
                
                if (!amountLkr.value || amountLkr.value < 1000 || amountLkr.value > 100000) {
                    amountLkr.classList.add('error');
                    amountLkr.nextElementSibling.style.display = 'block';
                    isValid = false;
                } else {
                    amountLkr.classList.remove('error');
                    amountLkr.nextElementSibling.style.display = 'none';
                }
            }
            
            // Step 2 validation
            else if (step === 2) {
                const requiredFields = [
                    'beneficiary-bank', 
                    'beneficiary-account-type', 
                    'beneficiary-account', 
                    'beneficiary-name'
                ];
                
                requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value) {
                        field.classList.add('error');
                        field.nextElementSibling.style.display = 'block';
                        isValid = false;
                    } else {
                        field.classList.remove('error');
                        field.nextElementSibling.style.display = 'none';
                    }
                });
                
                // Validate account number format
                const accountNo = document.getElementById('beneficiary-account');
                if (accountNo.value && !/^[0-9]{8,20}$/.test(accountNo.value)) {
                    accountNo.classList.add('error');
                    accountNo.nextElementSibling.style.display = 'block';
                    isValid = false;
                }
                
                // Validate email if provided
                const email = document.getElementById('beneficiary-email');
                if (email.value && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value)) {
                    email.classList.add('error');
                    email.nextElementSibling.style.display = 'block';
                    isValid = false;
                }
            }
            
            return isValid;
        }
        
        // Calculate charges and amounts
        function calculateCharges() {
            const amountLkr = parseFloat(document.getElementById('amount-lkr').value) || 0;
            
            // Find applicable fee
            let fee = 0;
            for (const tier of feeStructure) {
                if (amountLkr >= tier.min && amountLkr <= tier.max) {
                    fee = tier.fee;
                    break;
                }
            }
            
            // Calculate amounts
            const amountUsd = (amountLkr / exchangeRate).toFixed(2);
            const totalUsd = (parseFloat(amountUsd) + fee).toFixed(2);
            
            // Update display
            document.getElementById('display-amount-lkr').textContent = amountLkr.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            
            document.getElementById('display-fee').textContent = fee.toFixed(2) + ' USD';
            document.getElementById('display-total').textContent = totalUsd + ' USD';
        }
        
        // Update country code based on selected country
        function updateCountryCode() {
            const country = document.getElementById('remitter-country').value;
            const code = countryCodeMap[country] || '';
            document.getElementById('remitter-country-code').textContent = code;
        }
        
        // Generate reference number
        function generateReference() {
            const now = new Date();
            const dateStr = now.getFullYear() + 
                           String(now.getMonth() + 1).padStart(2, '0') + 
                           String(now.getDate()).padStart(2, '0');
            const randomNum = Math.floor(100000 + Math.random() * 900000);
            return `HNB-REM-${dateStr}-${randomNum}`;
        }
        
        // Submit form (simulated)
        function submitForm() {
            if (validateStep(currentStep)) {
                // Validate payment details
                const paymentValid = validatePayment();
                const termsChecked = document.getElementById('terms-agreement').checked;
                
                if (!termsChecked) {
                    document.getElementById('terms-agreement').nextElementSibling.querySelector('.error-message').style.display = 'block';
                    return;
                } else {
                    document.getElementById('terms-agreement').nextElementSibling.querySelector('.error-message').style.display = 'none';
                }
                
                if (paymentValid && termsChecked) {
                    // Simulate successful transaction
                    showConfirmation();
                }
            }
        }
        
        // Validate payment details
        function validatePayment() {
            let isValid = true;
            const paymentFields = [
                'card-number', 
                'card-name', 
                'card-expiry', 
                'card-cvv'
            ];
            
            paymentFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value) {
                    field.classList.add('error');
                    field.nextElementSibling.style.display = 'block';
                    isValid = false;
                } else {
                    field.classList.remove('error');
                    field.nextElementSibling.style.display = 'none';
                }
            });
            
            return isValid;
        }
        
        // Show confirmation
        function showConfirmation() {
            // Hide current step
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step${currentStep}-progress`).classList.remove('active');
            
            // Set confirmation details
            document.getElementById('confirmation-ref').textContent = generateReference();
            document.getElementById('confirmation-purpose').textContent = 
                document.getElementById('transaction-purpose').options[document.getElementById('transaction-purpose').selectedIndex].text;
            document.getElementById('confirmation-amount').textContent = 
                parseFloat(document.getElementById('amount-lkr').value).toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }) + ' LKR';
            
            const totalUsd = document.getElementById('display-total').textContent;
            document.getElementById('confirmation-total').textContent = totalUsd;
            
            const bankName = document.getElementById('beneficiary-bank').options[document.getElementById('beneficiary-bank').selectedIndex].text;
            document.getElementById('confirmation-bank').textContent = bankName;
            
            document.getElementById('confirmation-account-type').textContent = 
                document.getElementById('beneficiary-account-type').options[document.getElementById('beneficiary-account-type').selectedIndex].text;
            
            document.getElementById('confirmation-account').textContent = document.getElementById('beneficiary-account').value;
            document.getElementById('confirmation-beneficiary').textContent = document.getElementById('beneficiary-name').value;
            document.getElementById('confirmation-remitter').textContent = document.getElementById('remitter-name').value;
            document.getElementById('confirmation-country').textContent = document.getElementById('remitter-country').value;
            document.getElementById('confirmation-email').textContent = document.getElementById('remitter-email').value;
            
            // Show confirmation
            document.getElementById('confirmation').classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Start new transaction
        function newTransaction() {
            // Reset form
            document.getElementById('confirmation').classList.remove('active');
            currentStep = 1;
            
            // Reset all steps to inactive except first
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById(`step${i}`).classList.remove('active');
                document.getElementById(`step${i}-progress`).classList.remove('active');
            }
            
            document.getElementById('step1').classList.add('active');
            document.getElementById('step1-progress').classList.add('active');
            
            // Clear form (in a real app, you might want to preserve some fields)
            document.querySelectorAll('input:not([type=radio]):not([type=checkbox]), select').forEach(field => {
                field.value = '';
            });
            
            document.querySelectorAll('input[type=radio], input[type=checkbox]').forEach(field => {
                field.checked = false;
            });
            
            // Reset calculations
            document.getElementById('display-amount-lkr').textContent = '0.00';
            document.getElementById('display-fee').textContent = '0.00 USD';
            document.getElementById('display-total').textContent = '0.00 USD';
            
            // Generate new reference
            generateReference();
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>